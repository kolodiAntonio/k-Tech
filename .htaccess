RewriteEngine On

# ----------------------------------------------------
# KORAK 2: Jedna verzija domene + HTTPS
# ----------------------------------------------------

# 1) Force HTTPS
RewriteCond %{HTTPS} !=on [OR]
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# 2) Remove WWW (www.k-tech.com.hr -> k-tech.com.hr)
RewriteCond %{HTTP_HOST} ^www\.k-tech\.com\.hr$ [NC]
RewriteRule ^ https://k-tech.com.hr%{REQUEST_URI} [R=301,L]

# ----------------------------------------------------
# KORAK 2: Duplikati homepagea
# ----------------------------------------------------

# 3) /index ili /index.html -> /
RewriteCond %{THE_REQUEST} \s/+index(\.html)?[\s?] [NC]
RewriteRule ^index(\.html)?$ https://k-tech.com.hr/ [R=301,L]

# ----------------------------------------------------
# "Clean URL" pravila (zadržavamo tvoju logiku)
# ----------------------------------------------------

# 4) /nešto.html -> /nešto   (samo ako je stvarno .html request)
RewriteCond %{THE_REQUEST} \s/+(.+?)\.html[\s?] [NC]
RewriteRule ^(.+)\.html$ https://k-tech.com.hr/%1 [R=301,L]

# 5) Interno mapiranje: /nešto -> /nešto.html (ako ne postoji file/folder)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ $1.html [L]
